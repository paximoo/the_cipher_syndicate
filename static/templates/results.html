{% extends 'base.html' %}

{% block main %}
<center>
<h1>{{ date }}</h1>
<div class="grid">
    {% for param in params %}
    <div class="card border-dark mb-3">
        <div class="card-header">{{ param }}</div>
            <div class="card-body text-dark">
                <h5 class="card-title">{{ avgs[loop.index0] }}</h5>
            </div>
    </div>    
    {% endfor %}
</div>
<form action='/download' method='post'>
    <button class="btn btn-primary" style="margin-top: 70px;" type='submit'>Download data as CSV</button>
</form>
<script>
    function toggleDetails() {
        const details = document.getElementById("table");
        const btn = document.getElementById("toggleBtn");

        if (details.style.display === "none" || details.style.display === "") {
            details.style.display = "block";
            btn.textContent = "Hide details...";
        } else {
            details.style.display = "none";
            btn.textContent = "More details...";
        }
    }
</script> 
<div class="details" id="toggleBtn" onclick="toggleDetails()">
    <p>More details...</p>
</div>
<div class="table-container" id="table" style="display: none;">
    <table class="table">
        <tr>
            <th>Year</th>
            {% for param in params %}
                <th scope="col">{{ param }}</th>
            {% endfor %}
        </tr>
        {% for reading in data %}
        <tr>
            {% for _, entry in reading.items() %}
                {% for _, value in entry.items() %}
                    <td scope="row">{{ value }}</td>
                {% endfor %}
            {% endfor %}
        </tr>
        {% endfor %}
    </table>
</div>
</center>
{% endblock %}
